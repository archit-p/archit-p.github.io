{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/linear-regression-restaurant-profits","result":{"pageContext":{"content":"<p>Machine Learning on Coursera week 1 exercise includes linear regression to predict food truck profits. The data contains the population of a city, and the profit generated by a food truck in that city. Our goal is to use this data so that given the population, we are able to predict the profit generated by a food truck in that city.</p>\n<h2>Part 1: Getting the Data</h2>\n<pre><code class=\"language-python\">import matplotlib.pyplot as plt\nimport numpy as np\n\npath = '/Users/archit-p/sources/coursera/machine-learning/machine-learning-ex1/ex1/ex1data1.txt'\n</code></pre>\n<pre><code class=\"language-python\">f = open(path, 'r')\n\ndataset = []\n\nfor line in f:\n    fields = line.strip().split(',')\n    fields[0] = float(fields[0])\n    fields[1] = float(fields[1])\n    dataset.append(fields)\n</code></pre>\n<pre><code class=\"language-python\">dataset[0:5]\n</code></pre>\n<pre><code>[[6.1101, 17.592],\n [5.5277, 9.1302],\n [8.5186, 13.662],\n [7.0032, 11.854],\n [5.8598, 6.8233]]\n</code></pre>\n<pre><code class=\"language-python\"># number of features\nn = len(dataset[0]) - 1\n\n# number of datapoints\nm = len(dataset)\n\nx = np.ones(shape=(m, n + 1))\ny = np.zeros(m)\n\nfor i, d in enumerate(dataset):\n    for j in range(n):\n        x[i][1 + j] = dataset[i][j]\n        y[i] = dataset[i][-1]\n\nfor j in range(n):\n    x[:, 1+j] = (x[:, 1+j] - np.ones(m) * x[:, 1+j].mean()) / x[:, 1+j].std()\n</code></pre>\n<pre><code class=\"language-python\">x[0:5]\n</code></pre>\n<pre><code>array([[ 1.        , -0.53240565],\n       [ 1.        , -0.68368294],\n       [ 1.        ,  0.09319761],\n       [ 1.        , -0.30042464],\n       [ 1.        , -0.5974206 ]])\n</code></pre>\n<pre><code class=\"language-python\">y[0:5]\n</code></pre>\n<pre><code>array([17.592 ,  9.1302, 13.662 , 11.854 ,  6.8233])\n</code></pre>\n<p>Plotting the data over a scatter plot gives us an idea of the distribution.</p>\n<pre><code class=\"language-python\">plt.scatter(x[:, 1], y)\nplt.show()\n</code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 368px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/36a247b83700639ac20cbd86f81bdfc1/2b727/output_9_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/0lEQVQ4y51TTU/bQBC1eujfQv0ZKa0Q9/6FHnureqCRSmlPVu+FUkBCkYqqtKoUQnsIiY3SYCA2+Cv+jrPrXU9nDSZOoCCx0njfeve9fTNjS7IsL1iWtYrx1jTNOs73hnk1O7ZV91y77jn2yuFg+OHX/u+apGna8zzP4SHDiggEaQYM6QnNQTsdfpKazeYy51zsExSmtwX/zzvk0IEd0VE8mQgBXdffSYqi1DhnYIYTxvjUaum66l7gci2OujEpsI3cSZbDxbmxJrVarSXhMCGMX3JmBcQQxLNRMpOu2AvGtJgzho4uHa5JvV6vdpUyHxOWn/spdI3gWoziPZoTA8l4IXCba3xMBQ/a+0uEMkHk6CQPUwrHdnxNwNvBDNKZFMvUK2WZCh71DhdjFNGcpEg5IVnhqocuh94Yu0jh1E0gpeyGu4rLqaDS7TzrXwSw8Udn7/f6+autLnw+GMKeYsJfKwJRgvmGVPENwXx09nSlocLL9Q5/s6vm8s9j6Og+lA0XzubF7nRIzMHix+99ePL6G+nqfoY1y0Tp8FSGogVGwn1Rfoerkj5Ql3/0bWifeOAlFGLCgbCH/TmGYcjY5fbC0YnRSOJoIwzDL77n7gSB/1XgIAg2HcfZQbwpcHUtwvO8Ldd1txGvR1HUUFX1hYTjMYpLZeB4NLeW7tqfj38ndvxnOumnCQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/36a247b83700639ac20cbd86f81bdfc1/2b727/output_9_0.png\"\n        srcset=\"/static/36a247b83700639ac20cbd86f81bdfc1/772e8/output_9_0.png 200w,\n/static/36a247b83700639ac20cbd86f81bdfc1/2b727/output_9_0.png 368w\"\n        sizes=\"(max-width: 368px) 100vw, 368px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>Part 2: Regression and Gradient Descent</h2>\n<p>In Part 2, we define the hypothesis, error and gradient functions and perform the minimization.</p>\n<pre><code class=\"language-python\">def hypothesis(theta, xi):\n    return np.matmul(np.transpose(theta), xi)\n</code></pre>\n<pre><code class=\"language-python\">def mse(theta):\n    sum = 0\n    predictions = np.zeros(m)\n    for i, xi in enumerate(x):\n        predictions[i] = hypothesis(theta, xi)\n    return ((predictions - y) ** 2).mean() / 2;\n</code></pre>\n<pre><code class=\"language-python\">mse(np.array([0, 0]))\n</code></pre>\n<pre><code>32.072733877455676\n</code></pre>\n<pre><code class=\"language-python\">def derivative(theta, j):\n    sum = 0\n    for xi, yi in zip(x, y):\n        sum += (hypothesis(theta, xi) - yi) * xi[j]\n    return sum / m\n</code></pre>\n<pre><code class=\"language-python\">derivative(np.zeros(n + 1), 0)\n</code></pre>\n<pre><code>-5.83913505154639\n</code></pre>\n<p>We minimize the cost function using a gradient descent algorithm.</p>\n<pre><code class=\"language-python\">%%time\ntheta = np.zeros(n + 1)\niterations = 2000\nalpha = 0.02\n\nh = np.zeros(iterations)\nfor i in range(iterations):\n    newtheta = np.zeros(n + 1)\n    for j in range(n + 1):\n        newtheta[j] = theta[j] - alpha * derivative(theta, j)\n    theta = newtheta\n    h[i] = mse(theta)\n\nprint(theta)\n</code></pre>\n<pre><code>[5.83913505 4.59304113]\nCPU times: user 1.6 s, sys: 8.92 ms, total: 1.61 s\nWall time: 1.62 s\n</code></pre>\n<p>In order to check whether the gradient descent is convering, we plot the value of the cost function after each iteration.</p>\n<pre><code class=\"language-python\">plt.plot(h)\nplt.show()\n</code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 368px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b73606a08c4e0f04eb67cb0ac96cc273/2b727/output_19_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABR0lEQVQ4y7WTzUrDQBhFBwVXooj4Qi58DX92xbrQFxJXxUKhFdqFK5expqYIlrTYJM20TSZpGrRtmmSaGWeS+r9qiB8cLnwzHC5DAkRR3DeRVXacccFxnOuUFFzXrciyfAqkRuPcnYU0i0EIFcEA6ofo1aMRIQEhBKfE50LDMC6B+FDPjyY+Fy7Yjp2RlZtxKU/TNK9AH+pHVtIwG2H9XjjLtCHUe8eZNmxKj7l/acg82QifmlJuPPVpgKNP4apE34Va9+XkzQvoZI4DtsMp+foOO2057+OIOuxvmWNCp8GCeiGhszD6gYfJ3wySnPiL+L1s2y4CQRAORrZ9O7TGJVmBVW1olztav6oOUKULjZsP2iqMdzyVPqrIil7jd3mqA6ukwuFdq/V8AbReDzB5DJudZW4uc42xzthgbINktpZnu79yj997B4AQ85kvm63VAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/b73606a08c4e0f04eb67cb0ac96cc273/2b727/output_19_0.png\"\n        srcset=\"/static/b73606a08c4e0f04eb67cb0ac96cc273/772e8/output_19_0.png 200w,\n/static/b73606a08c4e0f04eb67cb0ac96cc273/2b727/output_19_0.png 368w\"\n        sizes=\"(max-width: 368px) 100vw, 368px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>Part 3: Visualizing the Cost Function</h2>\n<p>In Part 3, we visualize the cost function to know whether it is a convex function. For this we use a contour plot and a surface plot of cost function values over a given grid.</p>\n<pre><code class=\"language-python\">%%time\ntheta0_vals = np.arange(4, 8, 0.1)\ntheta1_vals = np.arange(3, 6, 0.1)\n\ncost = np.zeros(shape=(len(theta1_vals), len(theta0_vals)))\n\nfor i, t1 in enumerate(theta1_vals):\n    for j, t0 in enumerate(theta0_vals):\n        cost[i][j] = mse(np.array([t0, t1]))\n</code></pre>\n<pre><code>CPU times: user 313 ms, sys: 4.4 ms, total: 317 ms\nWall time: 316 ms\n</code></pre>\n<pre><code class=\"language-python\"># create contour plot\nx_grid, y_grid = np.meshgrid(theta0_vals, theta1_vals)\nplt.contour(x_grid, y_grid, cost, levels=100, cmap='viridis', linewidths=0.5)\nplt.show()\n\n# create surface plot\nfig = plt.figure(figsize=(10, 10))\nax = plt.axes(projection='3d')\n\nax.plot_surface(x_grid, y_grid, cost, cmap='viridis')\nplt.show()\n</code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 372px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/02952e7a20e05aa043efdddebbcf1b0b/98b6e/output_23_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADLklEQVQ4yz1SyVIbVxTtRSp/lG3WWbkqA65glyH/4m0WiSsUWSRVsSnLMRgcGTtgCSE0RMiSkAFNLb2hR7W6WyMSYKEebm4/bL+qV6f7db9zz73nSBaA9Fd+935Cb0FGVaHIdKhSE+rEApnYQKgDFDf7iG08a5AenJIulKgBOa7CgUYh7TQgxZN1CZDwUXzzQYqTiMx7T0y/SSyfUNtXmesbSt83xXYFatz1kdyXSc8/J12/RHU/y5VFyiSw286/k87mM2kjk7qbpQyqzAwa1Aopc0BX+mDpQ3C7IxjaExg6E+hbY7CNIZjqADh3QaaolHbhmGnBkcEh3npXFgrXtl+sFpgKZ8wK2swOtYgML/Z7Y5gMpnA5uYKr6TVcDGeC2DZHYKh9oNyBOrOgzIwgp6sQb1bKUsV1pK1cbqlAFKjxXkAVRxA6eGmCBJcXV3Dz4QYW8wV8uJxjgZko1EX1XHGhyXpwgp3lNA1eNU9uFf6+s716jApr3AoId0Idq0cqxv0pzFDd/GoO8+sboTJS7FoR4W3bDUFoBPlPhO+nYymWPVrKUw6nrBvI2LKClbvaAOc3hpFzIVqdji5FgQGq6+E4oqIEZ13DlktMD7Ki5fKtwkc7m6sZzqGC0mtoSofZoGJ1E0kjEyJjhCHmEI0aCMMYkjXRlChiBTQlbTB4JRfLUsKUMYdv7yZ5W3yoECOsEStsk17IqB2qDEfA3RDjE2rMDTl1QoxU2MB/MGJhkWrhEefBQbcNbzqZW4W/vdl48NZowqGqLJDUQ1LvrNP1mqTnYd68DrG9dqfnYai9Fr7XOpZXJaZXpLqX4YqX0MlN2q1BWtkvSvXrkvRP5e/lpF6APbUO+0SGlNyBnMzhvwaDUlOFckOBCmKpqcBxA89bHNKtDiRJB/5leEevQsk9whw/kSVcXy6tfPNVvLr5w3ry+fLa3svlWD773a+xZz+9LlXvrMe2VrZTue8f77y+9yS+9+OzxOHS2vOtlZcnlTs/bz5dfVpOffvHwcbybmH93un5L1+LlnF9UZ9XxHO0d+vnAmOJQ4E1a/T5m/0R/9zfExgnZWkhzmbSYfqh9D8fFF7RfOa4nwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/02952e7a20e05aa043efdddebbcf1b0b/98b6e/output_23_0.png\"\n        srcset=\"/static/02952e7a20e05aa043efdddebbcf1b0b/772e8/output_23_0.png 200w,\n/static/02952e7a20e05aa043efdddebbcf1b0b/98b6e/output_23_0.png 372w\"\n        sizes=\"(max-width: 372px) 100vw, 372px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 558px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a8e540ded91167052ad34c776e329e2a/42a8d/output_23_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADsElEQVQ4y11U7YtUVRif/8BP0af8JAVCGalkVpYWrBpZQiYEQVQfLDPKTANLl2hXnbaZHV9o0T6ItX0qSWLXgbZ2JQKTqJBNyZbyBXd259459/3O3DvPzK/nOXvuzLgHnvuce15+z+88bzkAR9vt9q+sJ1lfEOF5R2eS7S0+Y+aTLJdYhnL8ETDwBjLdOyeizn/vyM4tkqkcfybNhZQ1ifCcWq0WRVFENaXI8zwKw5CSJCEZ2ZkeSQzg+ZyhDHNIjzRNwQDwfR++44NBYds2FGsRWWdjYAPZC7K75ZzxhfyIZTQaDQSBjzAIoTyFy5VpBvVQq9XgOI7WAppppWpsIJAXCHi5w5BaRFEcaeuu76EVJ/jl9jQ2TQzipjUHTzmaacZSgzOYw+uOqlG1WoXrugsM02bKT4jJ02A+RFO9gVcmvsaSkYP48KfzaDIDi1llTG3WrnJhqQr+taZJ1RxZXwCs82XHtymNYrTrCdBsonTxZ9xTzOP+/FHc11/A2Yt/oJ3GzMqGxf4MPJfFx5dXy7hhXydlqy5gMyHMOjM0OvMNxmamsf+HMu49XMCKj0pYvaeEVTuLWPtmCWcnfmNmEfs5xNy8hXfHzuHU5Sk0g5iqttXDkANBUULHr5zD3V/0Y9lAAQ/tLeGRN4bx+MtFbHixgCefH8K6Z/L4dHgI/fnv8NS+Ebz01SgCXweM5tmH7P8FQAl/yJEKohDbvx3F8g8KeGLHMWx44TP09R3B5vUD2LhiEDte24Uzf65G3/HX8VhxGNdmbyFif1ctiyzLkjQyQeG8czl50zjG33MVbPzkFNZuzWPL00fw3MoD2Lr0PTy7Zje2fb8TD4/txoOnBzD1z1XUGUwCxTmqAeM47gIyXR3llFPnr/9u4dU9p7H+gf3YtHQX1q16G8sGD+CuQx9jTf8JXPj9GiiuQ3G0PdfVgJVKRXLYBIWjGgQB+Z6nD9X56VW7hpNnfsT2t07g0XeK2Pz+CA5/Po6b1ytoNmJ9TnLWcR0NKInN5dplKI7lmoWI63rsbJ+zh1kwg9kb83DmFSiJOV+DLpijwTQZBuuWXgYom1lJcdbzBVcDh2EAn8tR8b+s62paeCpMyZHpB91a5mdLN+lY7q1XARbmulkYMAmCAev0Ac1Q2pfpFEnWjmSwg0kCxZdJ2IswOLExiahubYaZgCWG4bgwvLS4UWZD/CIBE5dwSmiWwlpal2F2RzOW1wrgEMuUNEfxgdAWnc17RdKCDZQlmovOjZuuNfA/kFSZ2CJIVsAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/a8e540ded91167052ad34c776e329e2a/42a8d/output_23_1.png\"\n        srcset=\"/static/a8e540ded91167052ad34c776e329e2a/772e8/output_23_1.png 200w,\n/static/a8e540ded91167052ad34c776e329e2a/e17e5/output_23_1.png 400w,\n/static/a8e540ded91167052ad34c776e329e2a/42a8d/output_23_1.png 558w\"\n        sizes=\"(max-width: 558px) 100vw, 558px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","frontmatter":{"slug":"/blog/linear-regression-restaurant-profits","title":"Linear Regression to Predict Restaurant Profits","date":"February 11th 2021"}}},"staticQueryHashes":[]}